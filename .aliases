#!/usr/bin/env zsh

# Source git aliases
source ~/.aliases-git

###################
# Modern CLI Tools
###################
# Use modern alternatives when available
command -v bat >/dev/null 2>&1 && alias cat="bat --plain --paging=never"
command -v eza >/dev/null 2>&1 && alias ls="eza --icons --git" && alias ll="eza -la --icons --git" && alias tree="eza --tree --icons"
command -v rg >/dev/null 2>&1 && alias grep="rg"
command -v fd >/dev/null 2>&1 && alias find="fd"
command -v duf >/dev/null 2>&1 && alias df="duf"
command -v dust >/dev/null 2>&1 && alias du="dust"
command -v procs >/dev/null 2>&1 && alias ps="procs"
command -v btop >/dev/null 2>&1 && alias top="btop"
command -v delta >/dev/null 2>&1 && alias diff="delta"
command -v fzf >/dev/null 2>&1 && alias preview="fzf --preview 'bat --color=always {}'"
command -v hyperfine >/dev/null 2>&1 && alias bench="hyperfine"
command -v doggo >/dev/null 2>&1 && alias dig="doggo"

###################
# File Operations
###################
alias t="touch"                   # Create new file
alias cp="cp -ia"                 # Interactive and archive
alias mv="mv -i"                  # Interactive move
alias rm="rm -I"                  # Interactive remove
alias mkdir="mkdir -pv"           # Create parent directories and verbose
alias chmod="chmod -v --preserve-root"  # Verbose mode with root protection
alias chown="chown -v --preserve-root"  # Verbose mode with root protection
alias tarz="tar --zstd -cf"       # Modern compression with zstd
alias extract='if [ -f "$1" ] ; then case "$1" in *.tar.bz2|*.tbz2) tar xjf "$1";; *.tar.gz|*.tgz) tar xzf "$1";; *.tar.xz) tar xJf "$1";; *.tar.zst) tar --zstd -xf "$1";; *.bz2) bunzip2 "$1";; *.rar) unrar x "$1";; *.gz) gunzip "$1";; *.tar) tar xf "$1";; *.zip) unzip "$1";; *.Z) uncompress "$1";; *.7z) 7z x "$1";; *) echo "\"$1\" cannot be extracted"; fi else echo "\"$1\" is not a valid file"; fi'

###################
# Navigation
###################
alias ..="cd .."
alias ...="cd ../.."
alias ....="cd ../../.."
alias -- -="cd -"
alias d='dirs -v'
for index ({1..9}) alias "$index"="cd -${index}"; unset index

###################
# Modern Development
###################
# Docker
alias dk="docker"
alias dkc="docker compose"        # New docker compose command
alias dkp="docker system prune -af --volumes"  # Clean all unused
alias dkt="docker container top"  # Process list in container
alias dkps="docker ps --format 'table {{.Names}}\t{{.Status}}\t{{.Ports}}'"
alias dklf="docker logs -f"

# Kubernetes
alias k="kubectl"
alias kn="kubens"                 # Kubernetes namespace switching
alias kx="kubectx"               # Kubernetes context switching
alias stern="stern --tail 50"     # Better kubernetes logs
alias kgp="kubectl get pods"
alias kgn="kubectl get nodes"
alias kdp="kubectl describe pod"

# Development Environments
alias py="python3"
alias python="python3"
alias pip="python3 -m pip"        # Always use module form
alias venv="python3 -m venv .venv && source .venv/bin/activate"
alias dva="deactivate"
alias pip-update="pip list --outdated --format=freeze | grep -v '^\-e' | cut -d = -f 1 | xargs -n1 pip install -U"

# Node.js - using modern practices
alias pnpm="corepack pnpm"        # Use corepack for package managers
alias nx="pnpm nx"                # Modern monorepo tool
alias nr="npm run"
alias nrd="npm run dev"
alias nrb="npm run build"
alias nrt="npm run test"
alias ncu="npx npm-check-updates"

# Go
alias gmt="go mod tidy"
alias gv="go vet"
alias gta="go test ./..."
alias gcv="go mod verify"
alias gow="gopls watch"           # Language server watch
alias gob="go build -v"
alias gor="go run -v"

# Rust
alias cb="cargo build"
alias cr="cargo run"
alias ct="cargo test"
alias cf="cargo fmt"
alias cc="cargo check"
alias cl="cargo clippy"
alias cw="cargo watch -x run"     # Watch mode
alias cu="cargo update"
alias coc="cargo outdated -R"

###################
# System Operations
###################
alias ports="ss -tulanp"          # Modern alternative to netstat
alias sysd="systemctl"
alias jctl="journalctl"
alias mem="free -h"
alias net="bandwhich"             # Network utilization
alias hist="atuin"                # Better shell history
alias psmem="ps auxf | sort -nr -k 4 | head -10"  # Top memory processes
alias pscpu="ps auxf | sort -nr -k 3 | head -10"  # Top CPU processes

###################
# Security
###################
alias sha256="shasum -a 256"
alias encrypt="age"               # Modern encryption
alias hash="b2sum"               # Better than md5/sha1
alias sshkeygen="ssh-keygen -t ed25519"
alias scan-ports="sudo nmap -sS"
alias myip="curl ifconfig.me"

###################
# Quality of Life
###################
alias path='echo -e ${PATH//:/\\n}'  # Print each PATH entry on a new line
alias timestamp='date "+%Y%m%d_%H%M%S"'
alias weather="curl wttr.in"
alias serve="python3 -m http.server"
alias cleanup="find . -type f -name '*.DS_Store' -ls -delete"
alias update="topgrade"           # Universal update tool
alias ip="ip -color=auto"
alias diff="diff --color=auto"
alias grep="grep --color=auto"

# Directory shortcuts with zoxide
# alias docs="z documents"
# alias dl="z downloads"
# alias code="z code"

# Editor
alias e="$EDITOR"
alias vim="nvim"
alias vi="nvim"
alias svim="sudo -E nvim"

if [[ "$OSTYPE" == "darwin"* ]]; then
    alias update='brew update && brew upgrade && mas upgrade && rustup update && pipx upgrade-all && z4h update'
else
    alias update='sudo apt update && sudo apt upgrade -y && rustup update && pipx upgrade-all && z4h update'
fi
